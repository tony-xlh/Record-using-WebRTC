<!DOCTYPE html>
<html lang="en">
  <head>
  <title>RecordRTC Simple Demos</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <style>
  </style>
  </head>

  <body>
  
<button id="btn-start-recording">Start Recording</button>
<button id="btn-stop-recording" disabled>Stop Recording</button>

<hr>
<video controls autoplay playsinline></video>

<script src="/RecordRTC.js"></script>
<script>
var video = document.querySelector('video');

function captureCamera(callback) {
  navigator.mediaDevices.getUserMedia({ audio: false, video: true }).then(function(camera) {
    //video.srcObject = camera;
    callback(camera);
  }).catch(function(error) {
    alert('Unable to capture your camera. Please check console logs.');
    console.error(error);
  });
}

function stopRecordingCallback() {
  video.src = video.srcObject = null;
  video.muted = false;
  video.volume = 1;
  video.src = URL.createObjectURL(recorder.getBlob());
  
  recorder.camera.stop();
  recorder.destroy();
  recorder = null;
}

var recorder; // globally accessible

document.getElementById('btn-start-recording').onclick = function() {
  this.disabled = true;
  captureCamera(function(camera) {
    video.muted = true;
    video.volume = 0;
    video.srcObject = camera;

    recorder = RecordRTC(camera, {
      type: 'video'
    });

    recorder.startRecording();

    // release camera on stopRecording
    recorder.camera = camera;

    document.getElementById('btn-stop-recording').disabled = false;
  });
};

document.getElementById('btn-stop-recording').onclick = function() {
  this.disabled = true;
  recorder.stopRecording(stopRecordingCallback);
};
</script>
  </body>
</html>